exp_id = 'exp_doubleEC_26_forest_s01';
exp_description = 'Surrogate CMA-ES, adaptive DTS, final parameters from Lukas'' thesis, PoI criterion, 2pop, xgboost, sample from forest parameters';

% BBOB/COCO framework settings

bbobParams = { ...
  'dimensions',         { 2, 3, 5, 10, 20 }, ...
  'functions',          num2cell(1:24), ...      % all functions: num2cell(1:24)
  'opt_function',       { @opt_s_cmaes }, ...
  'instances',          { [1:5, 41:50] }, ...    % default is [1:5, 41:50]
  'maxfunevals',        { '250 * dim' }, ...
  'resume',             { true }, ...
};

% Surrogate manager parameters

surrogateParams = { ...
  'evoControl',         { 'doubletrained' }, ...    % 'none', 'individual', 'generation', 'restricted'
  'observers',          { {'DTScreenStatistics'} }, ... 'DTFileStatistics'} },... % logging observers
  'modelType',          { 'forest' }, ...               % 'gp', 'rf', 'bbob'
  'updaterType',        { 'rankDiff' }, ...         % OrigRatioUpdater
  'DTAdaptive_updateRate',     { 0.3 }, ...
  'DTAdaptive_updateRateDown', { 'obj.updateRate' }, ...
  'DTAdaptive_maxRatio',       { 1.0 }, ...
  'DTAdaptive_minRatio',       { 0.04 }, ...
  'DTAdaptive_lowErr',         { '@(x) [ones(size(x,1),1) log(x(:,1)) x(:,2) log(x(:,1)).*x(:,2) x(:,2).^2] * [0.11; -0.0092; -0.13; 0.044; 0.14]' }, ...
  'DTAdaptive_highErr',        { '@(x) [ones(size(x,1),1) log(x(:,1)) x(:,2) log(x(:,1)).*x(:,2) x(:,2).^2] * [0.35; -0.047; 0.44; 0.044; -0.19]' }, ...
  'DTAdaptive_defaultErr',     { 0.05 }, ...
  'evoControlMaxDoubleTrainIterations', { 1 }, ...
  'evoControlPreSampleSize',       { 0.75 }, ...       % {0.25, 0.5, 0.75}, will be multip. by lambda
  'evoControlNBestPoints',         { 0 }, ...
  'evoControlValidationGenerationPeriod', { 4 }, ...
  'evoControlValidationPopSize',   { 0 }, ...
  'evoControlOrigPointsRoundFcn',  { 'ceil' }, ...  % 'ceil', 'getProbNumber'
  'evoControlIndividualExtension', { [] }, ...      % will be multip. by lambda
  'evoControlBestFromExtension',   { [] }, ...      % ratio of expanded popul.
  'evoControlTrainRange',          { 10 }, ...      % will be multip. by sigma
  'evoControlTrainNArchivePoints', { '15*dim' },... % will be myeval()'ed, 'nRequired', 'nEvaluated', 'lambda', 'dim' can be used
  'evoControlSampleRange',         { 1 }, ...       % will be multip. by sigma
  'evoControlOrigGenerations',     { [] }, ...
  'evoControlModelGenerations',    { [] }, ...
  'evoControlValidatePoints',      { [] }, ...
  'evoControlRestrictedParam',     { 0.05 }, ...
};

% Model parameters

modelParams = { ...
  'forestType',           { 'xgboost' }, ...
  'rf_nTrees',            { 2^8 }, ... 2.^[6 7 8 9 10] }, ...
  'rf_nFeaturesToSample', { 'ceil(0.75*dim)' }, ... { 'ceil(0.25*dim)', 'ceil(0.5*dim)', 'ceil(0.75*dim)', 'dim' }}, ...
  'rf_inBagFraction',     { 0.5 }, ... [ 0.25, 0.5, 0.75, 1.0 ]} ...
  'rf_boosting',          { true }, ...
  'tree_growFull',        { false }, ...
  'tree_predictorFunc',   { @ConstantModel }, ...
  'tree_minParentSize',   { 4 }, ...
  'weak_modelSpec',       { 'constant' }, ...
  'tree_splitFunc',       { @AxisSplit, @GaussianSplit, @HillClimbingObliqueSplit, @PairObliqueSplit, @ResidualObliqueSplit }, ...
  'tree_splitGainFunc',   { @GradientSplitGain }, ...
  'tree_maxDepth',        { 8 }, ...
  'splitGain_modelFunc',  { @Constant }, ...
  'split_nQuantize',      { 10 }, ...
  'split_nRepeats',       { 1000 }, ...
  'split_maxHyp',         { '10*dim' }, ...
  'predictionType',       { 'poi' }, ...
  'useShift',             { false }, ...
  'normalizeY',           { true }, ...
  'trainsetType'          { 'nearest' }, ...
  'trainRange',           { 4 }, ...
  'trainsetSizeMax'       { '20*dim' }, ...
};

% CMA-ES parameters

cmaesParams = { ...
  'PopSize',            { '(8 + floor(6*log(N)))' }, ...        %, '(8 + floor(6*log(N)))'};
  'Restarts',           { 50 }, ...
  'DispModulo',         { 0 }, ...
};

logDir = '/storage/plzen1/home/bajeluk/public';
